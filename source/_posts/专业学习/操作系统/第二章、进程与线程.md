---
title: 第一章 操作系统概论
date: 2022-3-14
top: false
tags: [操作系统]
categories: 学习
mathjax: true
---

# 1 进程和线程

## 1.1 进程的概念和特征

### 1.1.1 进程的概念

在多道程序环境下，允许多个程序并发执行，此时它们将失去封闭性，并具有间断性及不可再现性的特征。为此引入进程（Process）的概念，以便更好地描述和控制程序的并发执行，实现操作系统的并发性和共享性（最基本的两个特征）。

![进程的概念](https://raw.githubusercontent.com/unique-pure/PicLibrary/main/img/image-20220314210644915.png)

为了让参与并发执行的每个程序（含数据）都能独立运行，必须为之配置一个专门的数据结构，称为进程控制块（Porcess Control Block，PCB）。<font color="red">系统利用PCB来描述进程的基本情况和运行状态，进而控制和管理进程。</font>

相应地，由程序段、相关数据段和PCB三部分构成了进程实体（又称进程映像）。

![进程的组成](https://raw.githubusercontent.com/unique-pure/PicLibrary/main/img/image-20220314212439465.png)

所谓创建进程，实际上是创建进程实体中的PCB；而撤销进程，实质上是撤销进程的PCB。值得注意的是，进程映像是静态的，进程则是动态的。<font color="red">PCB是进程存在的唯一标志！</font>

引入进程实体的概念后，我们可以把传统操作系统中的进程定义为：”进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。“

### 1.1.2 进程的特征

进程是由多道程序的并发执行而引出的，它和程序是两个截然不同的概念。进程的基本特征是对比单个程序的顺序执行提出的，也是对进程管理的基本要求。

1） 动态性。进程是程序的一次执行，它有着创建、活动、暂停、终止等过程，具有确定的生命周期，是动态地产生、变化和消亡的。动态性是进程最基本的特征。

2） 并发性。指多个进程实体同时存在内存中，能在一段时间内同时运行。引入进程的目的就是使进程能和其他进程并发执行。并发性是进程的重要特征，也是操作系统的重要特征。

3） 独立性。指进程实体是一个能独立运行、独立获得资源和独立接收调度的基本单元，凡未建立PCB的程序，都不能作为一个独立的单位参与运行。

4） 异步性。由于进程的相互制约，使得进程按各自独立的、不可预知的速度向前推进。异步性会导致执行结果的不可再现性，为此在操作系统中必须配置相应的进程同步机制。

5） 结构性。每个进程都会配置一个PCB。结构上看，进程由程序段、数据段、PCB组成。

## 1.2 进程的状态与转换

进程在其生命周期内，由于系统中各进程之间的相互制约及系统的运行环境的变化，使得进程的状态也在不断发生改变。通常进程有以下5种状态，前3种是进程的基本状态。

1） 运行态。进程正在处理机上运行。在单处理机中，每个时刻只有一个进程处于运行态。

2） 就绪态。进程获得了除处理机外的一切所需资源，一旦得到处理机，便可立即运行。系统中处于就绪状态的进程可能有多个，通常将它们拍成一个队列，称为就绪队列。

3） 阻塞态，又称等待态。进程正在等待某一事件而暂停运行，如等待某资源为可用（不包括处理机）或等待输入/输出完成。即使处理机空闲，该进程也不能运行。系统通常将处于阻塞态的进程也排成一个队列，甚至根据阻塞原因的不同，设置多个阻塞队列。

4） 创建态。进程正在被创建，尚未转到就绪态。创建进程需要多个步骤：首先申请一个空白PCB，并向PCB中填写用于控制和管理进程的信息；然后为该进程分配运行时所必须的资源；最后把该进程转入就绪态并插入就绪队列。

5） 结束态。进程正从系统中消失，可能是进程正常结束或其他原因退出运行。进程需要结束运行时，系统首先将该进程置为结束态，然后进一步处理资源释放和回收等工作。

下图说明了5种进程状态的转换，而3种基本状态之间的转换如下：

* 就绪态->运行态：处于就绪态的进程被调度后，获得处理机资源（分派处理机时间片）。
* 运行态->就绪态：处于运行态的进程在时间片用完后，不得不让出处理机。
* 运行态->阻塞态：进程请求某一资源的使用和分配或等待某一事件的发生。
* 阻塞态->就绪态：进程等待的事件到来时，中断处理程序必须将相应进程的状态由阻塞态转换为就绪态。

![进程状态的转换](https://raw.githubusercontent.com/unique-pure/PicLibrary/main/img/v2-d32a519a8af469f4ccd6d02f96a88996_720w.jpg)

## 1.3 进程的组织

进程是一个独立的运行单位，也是操作系统进行资源分配和调度的基本单位。它由以下三部分组成，其中最核心的就是进程控制块（PCB）。PCB是给操作系统用的，而程序段、数据段是给进程自己用的。

1. **进程控制块**

   进程创建时，操作系统为它新建一个PCB，该结构之后常驻内存，任何时刻都可以存取，并在进程结束后删除。<font color="red">PCB是进程实体的一部分，是进程存在的唯一标志。</font>

   进程执行时，系统通过其PCB了解进程的现行状态信息，以便操作系统对其进行控制和管理；进程结束时，系统收回其PCB，该进程随之消亡。

   ![进程控制块](https://raw.githubusercontent.com/unique-pure/PicLibrary/main/img/image-20220314220449849.png)

2. **程序段**

   程序段就是能被进程调度程序调度到CPU执行的程序代码段。注意，程序可被多个进程共享，即多个进程可以运行同一程序。

3. **数据段**

   一个进程的数据段，可以是进程对应的程序加工处理的原始数据，也可以是程序执行时产生的中间或最终结果。

## 1.4 进程控制

进程控制的主要功能是对系统中的所有进程实施有效的管理，它具有创建新进程、撤销已有进程、实现进程状态转换等功能。简化理解：反正进程控制就是要实现进程状态转换。<font color="red">在操作系统中，一般把进程控制用的程序称为原语，原语的特点是执行期间不允许中断，它是一个不可分割的基本单位。</font>

1. 进程的创建

   允许一个进程创建另一个进程，此时创建者称为父进程，被创建的进程称为子进程。子进程可以继承父进程所拥有的资源。当子进程被撤销时，应将其从父进程那里获得的资源归还给父进程。此外，在撤销父进程时，通常也会同时撤销其所有的子进程。

